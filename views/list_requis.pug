include css.pug
style(media='print').
  @page { 
    margin-top: 2cm;
    margin-left: 0.5cm;
    margin-right: 0.5cm;
  }
doctype html
html
  head
    meta(charset="utf-8")
    title report
  body
    button.btn.btn-sm.btn-success(onclick='window.print()') Print
    - for(var page in list_requis)
      .page
      table.table
        thead
          tr 
            td.center.bold(colspan='10') #{hospitalName} 
          tr 
            td.center.bold(colspan='10') ใบจัดเวชภัณฑ์ตามใบเบิก
          tr 
            td.center(colspan='10') วันที่เบิก #{list_requis[page][0].requisition_date}
          tr 
            td.left(colspan='10') ใบเบิกเลขที่ #{list_requis[page][0].requisition_code}
          tr 
            td.left(colspan='10') วันที่อนุมัติเบิก #{list_requis[page][0].confirm_date}
          tr 
            td.left(colspan='10') หน่วยงานที่เบิก #{list_requis[page][0].warehouse_name}
          tr 
            td.left(colspan='10') หน่วยงานที่จ่าย #{list_requis[page][0].withdraw_warehouse_name}
          tr 
            td.left(colspan='10') ณ วันที่ #{today}
        - for(var head in list_requis[page])
          tbody
            tr.dash-top
              td(style='border:none;') รหัสยา 
              td(colspan='9') : #{list_requis[page][head].title.generic_code}
            tr
              td ชื่อสามัญ
              td(colspan='7') : #{list_requis[page][head].title.generic_name}
              td จำนวนขอเบิก
              td #{list_requis[page][head].title.requisition_qty} #{list_requis[page][head].title.large_unit} (#{list_requis[page][head].title.unit_qty} #{list_requis[page][head].title.small_unit})
            tr
              td หน่วยบรรจุ
              td : #{list_requis[page][head].title.large_unit}
              td
              td
              td
              td รูปแบบ
              td(colspan='2')  : #{list_requis[page][head].title.dosage_sane}
              td จำนวนเบิก
              td #{list_requis[page][head].title.confirm_qty} #{list_requis[page][head].title.large_unit} (#{list_requis[page][head].title.unit_qty} #{list_requis[page][head].title.small_unit})
            tr
              td.center(colspan='4') ชื่อทางการค้า 
              td จำนวนเบิก
              td วันหมดอายุ
              td ที่เก็บ
              td lot no.
              td เลขทะเบียน
              td คงเหลือ
              - for(var detail in list_requis[page][head].title.items)
                tr
                  td(colspan="4") #{list_requis[page][head].title.items[detail].generic_name}
                  td #{list_requis[page][head].title.items[detail].confirm_qty}
                  td #{list_requis[page][head].title.items[detail].expired_date}
                  td #{list_requis[page][head].title.items[detail].location_name}
                  td #{list_requis[page][head].title.items[detail].lot_no}
                  td
                  td #{list_requis[page][head].title.items[detail].remain} #{list_requis[page][head].title.items[detail].large_unit} (#{list_requis[page][head].title.items[detail].conversion_qty} #{list_requis[page][head].title.items[detail].small_unit})
            tr.dash-bottom
              td(colspan='10')
      .pagebreak
